import{_ as s,c as i,o as a,a5 as e}from"./chunks/framework.BSof0eVz.js";const l="/linux/assets/1.D6xlB-KZ.png",n="/linux/assets/2.DiHpk_PV.png",t="/linux/assets/3.DKos9T2i.png",p="/linux/assets/4.4sea8EJy.png",h="/linux/assets/5.DYkVFMQY.gif",d="/linux/assets/6.BVamzNCX.gif",r="/linux/assets/7.CddqsI-Y.png",k="/linux/assets/8.97QH9GU0.png",c="/linux/assets/9.C4nBmyPz.png",o="/linux/assets/10.BQVH6SpC.gif",u="/linux/assets/11.Bsg2Zood.gif",g="/linux/assets/12.CA3JYGNK.webp",b="/linux/assets/13.Ce8j9ZRu.gif",m="/linux/assets/14.RKCFl3ZP.gif",F="/linux/assets/15.DBMmPKYY.jpg",v="/linux/assets/16.Ce1_T03A.png",y="/linux/assets/17.IKJKVwnA.png",C="/linux/assets/18.CdSH2JB8.jpeg",B="/linux/assets/19.DbMffija.png",E="/linux/assets/20.BomEu6ZI.webp",x="/linux/assets/21.BuquOjw9.png",A="/linux/assets/22._IlMqoFk.jpg",D="/linux/assets/23.DE_97s7j.gif",_="/linux/assets/24.D4EcOz_4.gif",f="/linux/assets/25.DZNwnNsl.gif",w="/linux/assets/26.Cs69UC8U.gif",q="/linux/assets/27.C2CTDuCY.gif",P="/linux/assets/28.DkqOX6Hz.gif",I="/linux/assets/29.Cf4j6hvf.gif",S="/linux/assets/30.BWO9sJ80.gif",M="/linux/assets/31.BiV-hD8l.gif",L="/linux/assets/32.C80gTttL.gif",T="/linux/assets/33.cdtxGe70.gif",U="/linux/assets/34.Dk0PzBeY.png",R="/linux/assets/35.qHaSe-fU.jpg",G="/linux/assets/36.DkDkQ9El.png",N="/linux/assets/37.PzR_Wndx.png",O="/linux/assets/38.Cnbx7-90.png",V="/linux/assets/39.BfIp8jgm.png",Y="/linux/assets/40.DvJKw2he.png",H="/linux/assets/41.CNgjBMQf.png",z="/linux/assets/42.BMP9LSM8.png",j="/linux/assets/43.CpgraO_A.png",Z="/linux/assets/44.Qd075rRP.png",K="/linux/assets/45.IzVmNZUh.gif",X="/linux/assets/46.CV2Wik0t.gif",J="/linux/assets/47.BjKYw18d.gif",W="/linux/assets/48.BfT2ppQZ.gif",Q="/linux/assets/49.C1mQNOE7.gif",$="/linux/assets/50.mfbIyR4n.gif",ss="/linux/assets/51.R7zhYwsU.gif",is="/linux/assets/52.BnFna2nG.gif",as="/linux/assets/53.CpsEFF5y.gif",es="/linux/assets/54.DYE74Mw2.gif",ls="/linux/assets/55._3HeNbvU.gif",ns="/linux/assets/56.BEt2PYag.png",ts="/linux/assets/57.B6PAX9g6.gif",ps="/linux/assets/5.Ct5TXoVI.png",hs="/linux/assets/58.CXIEvX2u.gif",ds="/linux/assets/59.T-iu9vZb.gif",rs="/linux/assets/60.DQtClanZ.gif",ks="/linux/assets/61.DsNFMCtW.gif",cs="/linux/assets/62.BCgdsKmf.gif",os="/linux/assets/63.BghlChs1.gif",us="/linux/assets/64.CrjO0Kbo.gif",gs="/linux/assets/65.CpnOVt6t.gif",bs="/linux/assets/66.vmWDGtUL.gif",ms="/linux/assets/67.DcLxAcLH.gif",Fs="/linux/assets/68.DwDOwcWX.png",vs="/linux/assets/69.BhhiXauC.png",ys="/linux/assets/70.CP2guf8V.gif",Cs="/linux/assets/71.BD-he3Bd.gif",Bs="/linux/assets/72.RdgzPYqS.gif",Es="/linux/assets/73.O4hMjgn4.gif",xs="/linux/assets/74.C-Y1CPSi.gif",As="/linux/assets/75.CBflzqtj.gif",Ds="/linux/assets/76.BLgt_geB.gif",_s="/linux/assets/77.DUEHlTYp.gif",fs="/linux/assets/78.CRaXgunB.gif",ws="/linux/assets/79.Dz6xgKEu.gif",qs="/linux/assets/80.vNlSFq9m.gif",Ps="/linux/assets/81.CI7f97ul.gif",Is="/linux/assets/82.CoEVCbEl.gif",Ss="/linux/assets/83.DGt_Tb0g.gif",Ms="/linux/assets/84.AQd54taH.gif",Ls="/linux/assets/85.C7arXhcZ.gif",Ts="/linux/assets/86.CcGsnPvX.gif",Us="/linux/assets/87.DeqJ8yg5.gif",Rs="/linux/assets/88.CL7NJ08C.gif",Gs="/linux/assets/89.DA2p2Y7M.gif",Ns="/linux/assets/90.CoSLloEy.gif",Os="/linux/assets/91.B6uHHg77.gif",Vs="/linux/assets/92.Bc3mkWR3.gif",Ys="/linux/assets/93.D3GIvdRa.gif",Hs="/linux/assets/94.DZbmhgVD.gif",zs="/linux/assets/95.YBIuWLbD.gif",js="/linux/assets/96.B5Adq7IG.gif",Zs="/linux/assets/97.BmiDziaR.gif",Ks="/linux/assets/98.Ck1OeL2S.gif",Xs="/linux/assets/99.Bm8ZVDmR.gif",Js="/linux/assets/100.BkNYllhz.gif",Ws="/linux/assets/101.gwW7DCEh.gif",Qs="/linux/assets/102.Ccb7UIjj.gif",$s="/linux/assets/103.BJFb1dtT.gif",si="/linux/assets/104.xkCOphRc.gif",ii="/linux/assets/105.B36nSV-j.gif",ai="/linux/assets/106.LPmGMyuc.gif",ei="/linux/assets/107.D_UVUNRl.gif",li="/linux/assets/108.MVZThr9n.gif",ni="/linux/assets/109.gAwEeNEs.gif",ti="/linux/assets/110.Bympx9rq.gif",Fi=JSON.parse('{"title":"第一章：磁盘结构","description":"","frontmatter":{},"headers":[],"relativePath":"notes/01_linux_basic/18_xdx/index.md","filePath":"notes/01_linux_basic/18_xdx/index.md","lastUpdated":1717724052000}'),pi={name:"notes/01_linux_basic/18_xdx/index.md"},hi=e('<h1 id="第一章-磁盘结构" tabindex="-1">第一章：磁盘结构 <a class="header-anchor" href="#第一章-磁盘结构" aria-label="Permalink to &quot;第一章：磁盘结构&quot;">​</a></h1><h2 id="_1-1-准备工作" tabindex="-1">1.1 准备工作 <a class="header-anchor" href="#_1-1-准备工作" aria-label="Permalink to &quot;1.1 准备工作&quot;">​</a></h2><ul><li>在之前，我们在<a href="https://aexiar.github.io/linux/notes/01_linux_basic/01_xdx/" target="_blank" rel="noreferrer">安装操作系统</a>的时候，对于磁盘是通过<code>自动安装分区</code>的方式；但是，本次将采用<code>自定义安装分区</code>的方式，其划分如下：</li></ul><table tabindex="0"><thead><tr><th>分区名称</th><th>推荐大小</th><th>说明</th></tr></thead><tbody><tr><td>引导分区（/boot）</td><td>500MB - 1GB。</td><td>存放引导加载程序和内核。<br>通常建议单独分区以避免引导相关问题。</td></tr><tr><td>交换分区（swap）</td><td>等于或略大于物理内存（RAM）的大小。</td><td>通常推荐 1-2 倍于RAM。<br>用于内存交换，帮助提高系统稳定性和性能，尤其是在内存不足的情况下。</td></tr><tr><td>根分区（/）</td><td>磁盘剩余的空间都划分给根分区。</td><td>这是最基本的分区，包含操作系统及其大多数的核心文件。</td></tr></tbody></table><ul><li>本人的配置，如下所示：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NAME,SIZE,FSTYPE,MOUNTPOINT</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+l+'" alt="image-20240528100501354"></p><ul><li>其对应的安装步骤如下（只给出不同的步骤，相同的步骤略）：</li></ul><p><img src="'+n+'" alt=""></p><p><img src="'+t+'" alt=""></p><ul><li>并且采用<code>最小安装</code>，即只安装基本功能：</li></ul><p><img src="'+p+`" alt=""></p><ul><li>安装必要的软件包：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config-manager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set-enabled</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> crb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> epel-release</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> autoconf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc-c++</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> glibc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> glibc-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pcre</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pcre-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssl-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-devel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zlib-devel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    tree</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tmux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lsof</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bzip2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nfs-utils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> man-pages</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash-completion</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    lrzsz</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> net-tools</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysstat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iotop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iftop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> htop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> telnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> psmisc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> httpd-tools</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bind-utils</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nethogs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> expect</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> groupinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Development Tools&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+h+'" alt=""></p><ul><li>切换为英文环境：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">localectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 查看当前的语言环境</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> locale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> en</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 搜索英文语言包</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> glibc-langpack-en</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 安装英文语言包</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">localectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-locale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LANG=en_US.UTF-8</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 切换 locale 为英文</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/locale.conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 手动加载配置文件，使其生效</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">localectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 查看当前的语言环境</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+d+`" alt=""></p><h2 id="_1-2-设备文件" tabindex="-1">1.2 设备文件 <a class="header-anchor" href="#_1-2-设备文件" aria-label="Permalink to &quot;1.2 设备文件&quot;">​</a></h2><ul><li>Linux 中的哲学是：一切皆文件。对于普通文件而言，如果使用 C 语言来操作文件，通常会涉及到以下的四个函数：</li></ul><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 打开文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> pathname</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 文件路径</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> flags</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 打开文件的标志</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> mode</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 文件权限（当创建文件时）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 文件描述符，如果出错返回 -1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pathname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> flags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mode_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 读取文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> fd</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 文件描述符</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 存储读取数据的缓冲区</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> count</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 要读取的字节数</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 实际读取的字节数，如果出错返回 -1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ssize_t</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> fd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 写入文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> fd</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 文件描述符</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 要写入数据的缓冲区</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> count</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 要写入的字节数</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 实际写入的字节数，如果出错返回 -1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ssize_t</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> write</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> fd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 关闭文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> fd</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 文件描述符</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@return</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 成功时返回 0，如果出错返回 -1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> fd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>在 Linux 中，设备文件（Device Files）也是一种文件，并且设备文件是指向系统硬件设备的特殊文件，它们通常位于 <code>/dev</code> 目录下。</li></ul><blockquote><p>注意⚠️：设备文件需要关联一个设备驱动程序，进而才能够和对应的硬件设备进行通信。</p></blockquote><ul><li>对于普通文件而言，我们知道：如果两个文件的 inode 相同（硬链接），就表明这两个文件是一样，即：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+r+'" alt=""></p><ul><li><p>但是，对于设备文件，却不一样；设备文件有两个主要的属性，即：<code>主设备号（major number）</code>和<code>次设备号（minor number）</code>。</p><ul><li>主设备号（major number）：用于标识设备的类型，即设备驱动程序。</li><li>次设备号（minor number）：用于标识同一类型中具体的设备实例。</li></ul></li><li><p>可以通过如下的命令，来查看设备文件的相应信息：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+k+'" alt="image-20240528110112359"></p><ul><li>Linux 中的设备类型，有如下两种：</li></ul><table tabindex="0"><thead><tr><th>设备类型</th><th>特点</th><th>例子</th></tr></thead><tbody><tr><td>块设备（block）</td><td>块设备是按<code>块</code>访问的设备，如：硬盘和光驱。<br>它们有缓冲区，数据按块传输，可以随机访问。</td><td>/dev/sda <br>/dev/sdb <br>/dev/sr0 <br>/dev/loop0 <br>/dev/nvme0n1</td></tr><tr><td>字符设备（char）</td><td>字符设备是按<code>字符</code>流访问的设备，如：终端和串口。<br>它们没有缓冲区，数据按字节传输。</td><td>/dev/null <br>/dev/zero <br>/dev/random <br>/dev/console <br>/dev/pts</td></tr></tbody></table><ul><li>并且，Linux 中的硬盘命名（针对于硬盘接口类型而言）的规则，如下所示：</li></ul><table tabindex="0"><thead><tr><th>设备类型</th><th>设备名称格式</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td>传统 IDE 硬盘</td><td><code>/dev/hd[a-d][1-16]</code></td><td>[a-d]：表示第几块硬盘。<br>[1-16]：表示第几块硬盘的第几个分区。</td><td><code>/dev/hda1</code>, <code>/dev/hdb3</code></td></tr><tr><td>SCSI/SATA/USB 硬盘</td><td><code>/dev/sd[a-z][1-15]</code></td><td>[a-z]：表示第几块硬盘。<br>[1-15]：表示第几块硬盘的第几个分区。</td><td><code>/dev/sda1</code>, <code>/dev/sdb2</code></td></tr><tr><td>NVMe 固态硬盘</td><td><code>/dev/nvme[0-9]n[0-9]</code></td><td>[0-9]：表示第几个 NVMe 固态硬盘。<br>[0-9]：表示第几个 NVMe 固态硬盘的第几个命名空间。</td><td><code>/dev/nvme0n1</code></td></tr><tr><td>NVMe 分区</td><td><code>/dev/nvme[0-9]n[0-9]p[1-15]</code></td><td>[0-9]：表示第几个 NVMe 固态硬盘。<br>[0-9]：表示第几个 NVMe 固态硬盘的第几个命名空间。<br>[1-15]：表示第几个 NVMe 固态硬盘的第几个命名空间的第几个分区。</td><td><code>/dev/nvme0n1p1</code></td></tr></tbody></table><ul><li>在 Linux 中，可以使用 mknod 命令来创建设备文件，其格式如下：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mknod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 设备文件名称</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MAJOR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MINOR</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>TYPTE 选项：</p><ul><li><code>b</code>：创建一个带有缓存区的块设备文件。</li><li><code>c</code>：创建一个不带缓冲区的字符设备文件。</li></ul></li><li><p>[MAJOR MINOR]：主设备号和次设备号。</p></li><li><p>示例：查询 CD-ROM 的主设备号和次设备号</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sr0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+c+'" alt=""></p><ul><li>示例：创建块设备文件</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mknod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> def-sr0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+o+'" alt=""></p><ul><li>示例：将刚创建的设备文件挂载到 /mnt 下，查看 CD-ROM 中的内容</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mnt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> def-sr0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+u+'" alt=""></p><h2 id="_1-3-硬盘类型" tabindex="-1">1.3 硬盘类型 <a class="header-anchor" href="#_1-3-硬盘类型" aria-label="Permalink to &quot;1.3 硬盘类型&quot;">​</a></h2><ul><li>硬盘类型（硬盘接口类型），如下所示：</li></ul><table tabindex="0"><thead><tr><th>接口类型</th><th>特点</th><th>典型传输速度</th></tr></thead><tbody><tr><td>IDE</td><td>又称为 PATA 接口，是一种老式硬盘接口类型，速度相对较慢，已逐渐被SATA 接口取代。</td><td>100-133 MB/s</td></tr><tr><td>SCSI</td><td>用于服务器和高性能工作站，支持多设备连接，具有高传输速度和可靠性，成本较高。</td><td>40-320 MB/s</td></tr><tr><td>SATA</td><td>传输速度快、连接稳定，常用于机械硬盘和固态硬盘。版本包括 SATA I（1.5Gbps）、SATA II（3.0Gbps）和SATA III（6.0Gbps）。</td><td>150 MB/s（SATA I），300 MB/s（SATA II），600 MB/s（SATA III）</td></tr><tr><td>SAS</td><td>SCSI 接口的串行版本，具有更高的传输速度和更强的连接能力，主要用于企业级存储设备和服务器。</td><td>300-1200 MB/s</td></tr><tr><td>USB</td><td>主要用于外接硬盘，通过 USB 接口（如：USB 2.0、USB 3.0、USB 3.1 等）连接到计算机，便于移动存储和数据传输。</td><td>60 MB/s（USB 2.0），625 MB/s（USB 3.0），1250 MB/s（USB 3.1）</td></tr><tr><td>M.2</td><td>为固态硬盘设计的小型接口，支持 NVMe 协议，具有极高的读写速度和低延迟，常用于高性能笔记本和台式机。</td><td>1000-3500 MB/s（依赖于 PCIe 通道数量）</td></tr></tbody></table><ul><li>硬盘接口类型的作用： <ul><li>① 连接硬盘和主板：接口类型决定了硬盘如何物理连接到计算机的主板上。</li><li>② 速度传输速率：接口类型会影响数据在硬盘和主板之间传输的最大速率。</li><li>③ 兼容性：不同的接口类型对应不同的标准和协议，确保硬盘与主板及其他组件的兼容性。</li></ul></li></ul><blockquote><p>注意⚠️：接口类型主要用于连接硬盘和主板，传输数据的效率和速度确实会受到接口类型的影响，但并不是唯一因素。影响硬盘速度的因素如下：</p><ul><li>① <strong>硬盘技术</strong>： <ul><li>机械硬盘（HDD）：依赖旋转磁盘和读写头，速度较慢。</li><li>固态硬盘（SSD）：利用闪存技术，速度较快。</li><li>NVMe SSD：使用 NVMe 协议和 PCIe 总线，速度更快。</li></ul></li><li>② <strong>接口类型</strong>： <ul><li>SATA：常见于 HDD 和 SATA SSD，最大传输速度为 600 MB/s。</li><li>PCIe/NVMe：常见于高性能 SSD，传输速度可达 3500 MB/s 甚至更高。</li></ul></li><li>③ <strong>主板和系统配置</strong>：主板支持的接口类型和带宽限制也会影响硬盘的实际性能。</li></ul></blockquote><h2 id="_1-4-机械硬盘和固态硬盘" tabindex="-1">1.4 机械硬盘和固态硬盘 <a class="header-anchor" href="#_1-4-机械硬盘和固态硬盘" aria-label="Permalink to &quot;1.4 机械硬盘和固态硬盘&quot;">​</a></h2><h3 id="_1-4-1-机械硬盘" tabindex="-1">1.4.1 机械硬盘 <a class="header-anchor" href="#_1-4-1-机械硬盘" aria-label="Permalink to &quot;1.4.1 机械硬盘&quot;">​</a></h3><ul><li>定义：机械硬盘（HDD，Hard Disk Drive）是一种带有机械马达结构的存储装置，主要由：盘片，磁头，盘片转轴及控制电 机，磁头控制器，数据转换器，接口，缓存等几个部分组成。</li><li>内部构造：</li></ul><p><img src="'+g+'" alt=""></p><ul><li>机械硬盘的<a href="https://www.youtube.com/watch?v=dGRJc9ruRnk" target="_blank" rel="noreferrer">工作原理</a>，如下所示：</li></ul><table tabindex="0"><thead><tr><th>关键组件</th><th>特点</th></tr></thead><tbody><tr><td>盘片和旋转轴</td><td>机械硬盘内部包含多个盘片，这些盘片平行安装在一个旋转轴上。<br>盘片高速旋转，通常达到每分钟几千转（RPM）。</td></tr><tr><td>磁头和磁头控制器</td><td>每个盘片的存储面上都有一个磁头，负责读取和写入数据。<br>磁头与盘片之间的距离非常小，比一根头发丝的直径还要小。<br>所有的磁头连接到一个磁头控制器上，由控制器控制各个磁头的移动。</td></tr></tbody></table><ul><li>机械硬盘的数据读写过程： <ul><li>磁头可以沿着盘片的半径方向移动，结合盘片的高速旋转，磁头能够快速定位到盘片的指定位置进行数据读写。</li><li>数据写入：磁头通过电磁流改变盘片上磁性材料的极性来记录数据。</li><li>数据读取：磁头感应盘片上磁性材料的极性变化，将其转换为电信号读取数据。</li></ul></li><li>其对应的动画，如下所示：</li></ul><p><img src="'+b+'" alt=""></p><p><img src="'+m+'" alt=""></p><blockquote><p>注意⚠️：</p><ul><li><p>① 硬盘是精密设备，内部空气需要保持清洁。</p></li><li><p>② 进入硬盘的空气必须经过过滤，以防止灰尘和杂质损害盘片和磁头。</p></li><li><p>③ 机械硬盘读取数据的时间 = 寻道（寻找数据所在的磁道）+ 机械硬盘转速的时间 + 数据读写的时间。</p></li></ul></blockquote><h3 id="_1-4-2-固态硬盘" tabindex="-1">1.4.2 固态硬盘 <a class="header-anchor" href="#_1-4-2-固态硬盘" aria-label="Permalink to &quot;1.4.2 固态硬盘&quot;">​</a></h3><ul><li>定义：固态硬盘（SSD，Solid State Drive）是一种不带有机械马达结构的存储装置，主要带有闪存、主控芯片、缓存。</li><li>内部构造：</li></ul><p><img src="'+F+'" alt=""></p><ul><li>其工作原理，如下所示：</li></ul><table tabindex="0"><thead><tr><th>关键组件</th><th>特点</th></tr></thead><tbody><tr><td>闪存存储芯片</td><td>SSD 主要依靠闪存芯片来存储数据。闪存是一种非易失性存储器，即使断电后数据也不会丢失。<br>常见的闪存类型包括 NAND 闪存和 NOR 闪存，SSD 通常使用 NAND 闪存。</td></tr><tr><td>存储单元</td><td>闪存芯片由多个存储单元组成，每个存储单元可以存储一个或多个比特的数据。<br>根据存储单元的比特数，闪存分为 SLC（单层单元）、MLC（多层单元）、TLC（三层单元）和 QLC（四层单元）等类型。<br>比特数越多，存储密度越高，但耐久性和速度相对较低。</td></tr><tr><td>控制器</td><td>SSD 内部有一个控制器，负责管理数据的读写、垃圾回收（Garbage Collection）、错误校正（Error Correction）等操作。<br>控制器还处理数据的均匀写入（Wear Leveling），以延长 SSD 的寿命。</td></tr><tr><td>缓存</td><td>许多 SSD 配备了缓存（如：DRAM缓存），用于加速数据的读写操作。<br>缓存可以提高性能，特别是在处理小文件或频繁访问的数据时。</td></tr></tbody></table><ul><li><p>固态硬盘的数据读写过程：</p><ul><li><p>写入数据：控制器将数据以电信号的形式发送到闪存单元，通过改变存储单元的电荷状态来记录数据。</p></li><li><p>读取数据：控制器通过检测存储单元的电荷状态来读取数据，并将其转换回电信号。</p></li></ul></li></ul><blockquote><p>注意⚠️：</p><ul><li><p>① <strong>垃圾回收</strong>：由于闪存的特性，写入新数据前需要先擦除旧数据。垃圾回收机制定期整理和清理存储单元，确保有足够的空闲空间用于新数据的写入。</p></li><li><p>② <strong>均匀写入</strong>：控制器将数据写入分散到不同的存储单元，以防止某些单元过度磨损，延长 SSD 的使用寿命。</p></li></ul></blockquote><h2 id="_1-5-硬盘术语" tabindex="-1">1.5 硬盘术语 <a class="header-anchor" href="#_1-5-硬盘术语" aria-label="Permalink to &quot;1.5 硬盘术语&quot;">​</a></h2><h3 id="_1-5-1-chs" tabindex="-1">1.5.1 CHS <a class="header-anchor" href="#_1-5-1-chs" aria-label="Permalink to &quot;1.5.1 CHS&quot;">​</a></h3><ul><li><p>机械硬盘的内部结构中，会出现如下的概念：</p><ul><li><strong>磁头（head）</strong>：磁盘驱动器中的磁头用于读取和写入磁盘上的数据。每个磁盘表面都有一个磁头。</li><li><strong>磁道（track）</strong>：磁盘上同心圆形的路径，每个磁盘表面有多个磁道，用于存储数据。</li><li><strong>扇区（sector）</strong>：每个磁道分成若干扇区，是磁盘上最小的数据存储单位。每个扇区通常大小为 512 字节。</li><li><strong>柱面(cylinder)</strong>：柱面是垂直穿过磁盘所有盘片同一磁道的集合。换句话说，在不同盘片上但同一位置的磁道组成一个柱面。</li></ul></li><li><p>其对应的逻辑图，如下所示：</p></li></ul><p><img src="'+v+'" alt="file"></p><blockquote><p>注意⚠️：</p><ul><li>① 磁头的数量 = 盘面的数量。</li><li>② 磁道的数量 = 柱面的数量。</li><li>③ 1 柱面 = 扇区的大小（521 B）× 扇区的数量（磁道的数量） × 磁头的数量。</li><li>④ 在 RHEL 5 之前的版本中，Linux 是以柱面的整数倍划分分区的（这种方式也称为 CHS（Cylinder Head Sector））；但是，在 RHEL 6 之后，Linux 都是以扇区来划分分区。</li></ul></blockquote><ul><li>示例：查看扇区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+y+'" alt="image-20240528143242610"></p><h3 id="_1-5-2-lba-logical-block-addressing" tabindex="-1">1.5.2 LBA（logical block addressing） <a class="header-anchor" href="#_1-5-2-lba-logical-block-addressing" aria-label="Permalink to &quot;1.5.2 LBA（logical block addressing）&quot;">​</a></h3><ul><li>在之前的 CHS 中，机械硬盘是这样划分的：</li></ul><p><img src="'+C+'" alt="img"></p><ul><li>CHS 是采用 24 bit 寻址的；其中，前 10 bit 表示 cylinder，中间 8 bit 表示 head，后面 6 bit 表示 sector ，即最大寻址空间是：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;2 ^ 24 * 512 / 1024 / 1024 / 1024 &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 8 GB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+B+'" alt=""></p><ul><li><p>之所以，不再采用 CHS 的方式，就是因为它的最大寻址空间只支持 8GB ；现在的硬盘的容量，早就远远超过了 8GB。所以，现代的操作系统都是采用 LBA（logical block addressing）的方式，即：</p><ul><li>LBA 是一个整数，通过转换成 CHS 格式完成磁盘具体寻址 。</li><li>ATA-1 规范中定义了 28 位寻址模式，以每扇区 512 位组来计算，ATA-1 所定义的 28 位 LBA 上限达到 128 GB。</li><li>2002 年 ATA-6 规范采用 48 位 LBA，同样以每扇区 512 位组计算容量上限可达 128 PB。</li></ul></li><li><p>其对应的机械硬盘，是这么划分的：</p></li></ul><p><img src="'+E+'" alt="img"></p><h1 id="第二章-存储管理" tabindex="-1">第二章：存储管理 <a class="header-anchor" href="#第二章-存储管理" aria-label="Permalink to &quot;第二章：存储管理&quot;">​</a></h1><h2 id="_2-1-概述" tabindex="-1">2.1 概述 <a class="header-anchor" href="#_2-1-概述" aria-label="Permalink to &quot;2.1 概述&quot;">​</a></h2><ul><li>在 Linux 中，对于一个新的硬盘的使用步骤，如下所示： <ul><li>① 分区：分区是将硬盘划分为独立区域的过程，每个分区可以独立使用和管理。</li><li>② 格式化：格式化是将文件系统写入分区的过程，以便操作系统能够读取和写入数据。</li><li>③ 挂载：挂载是将格式化的分区连接到文件系统树的过程，以便用户能够访问分区上的数据。</li></ul></li></ul><blockquote><p>注意⚠️：win 和 Linux 有所不同；win 中不需要进行挂载，是由系统帮你自动挂载的。</p></blockquote><h2 id="_2-2-分区的好处" tabindex="-1">2.2 分区的好处 <a class="header-anchor" href="#_2-2-分区的好处" aria-label="Permalink to &quot;2.2 分区的好处&quot;">​</a></h2><ul><li><p>在计算机系统中，对硬盘进行分区有很多原因，即：</p><ul><li>① 优化 I/O 性能。</li><li>② 实现磁盘空间配额限制。</li><li>③ 提高修复速度。</li><li>④ 隔离系统和程序。</li><li>⑤ 安装多个OS 。</li><li>⑥ 采用不同文件系统。</li></ul></li><li><p>如果不对硬盘进行分区，将无法直接写入文件系统，原因如下：</p><ul><li>① 分区表的作用： <ul><li>硬盘上的分区表是存储设备的 <strong>“目录”</strong>，记录了每个分区的起始位置、大小等信息。</li><li>操作系统依赖分区表来识别和访问硬盘上的不同分区。</li><li>没有分区表，操作系统无法正确识别和管理磁盘空间。</li></ul></li><li>② 文件系统依赖分区： <ul><li>文件系统必须创建在分区上。分区提供了文件系统的边界和管理机制。</li><li>没有分区，文件系统无法找到其管理的起始和结束位置，无法在磁盘上正确组织和存储数据。</li></ul></li><li>③ 物理和逻辑管理： <ul><li>分区帮助将硬盘的物理空间组织成更小的逻辑单元。</li><li>每个分区可以独立管理，这简化了数据管理，提高了效率和安全性。例如：可以为不同用途（操作系统、数据、备份等）创建不同的分区，便于管理和维护。</li></ul></li><li>④ 兼容性和标准化： <ul><li>大多数操作系统和硬件控制器，都期望硬盘按照标准分区方案进行组织。</li><li>分区方案（如 MBR 或 GPT）是行业标准，确保不同系统和设备之间的兼容性；如果不使用分区，可能会导致兼容性问题，使硬盘无法在不同系统中正常使用。</li></ul></li></ul></li></ul><h2 id="_2-3-分区的方式" tabindex="-1">2.3 分区的方式 <a class="header-anchor" href="#_2-3-分区的方式" aria-label="Permalink to &quot;2.3 分区的方式&quot;">​</a></h2><h3 id="_2-3-1-概述" tabindex="-1">2.3.1 概述 <a class="header-anchor" href="#_2-3-1-概述" aria-label="Permalink to &quot;2.3.1 概述&quot;">​</a></h3><ul><li>目前，主流的硬盘分区方式，有如下的两种： <ul><li>MBR（Master Boot Record，主记录引导）。</li><li>GPT（GUID Partition Table，GUID 分区表）。</li></ul></li></ul><blockquote><p>注意⚠️：</p><ul><li>① 目前，Win11 和 MacOS 已经强制使用 GPT 分区格式。</li><li>② Linux 目前还支持 MBR 分区格式；但是，GPT 分区格式是趋势。</li></ul></blockquote><h3 id="_2-3-2-mbr-分区" tabindex="-1">2.3.2 MBR 分区 <a class="header-anchor" href="#_2-3-2-mbr-分区" aria-label="Permalink to &quot;2.3.2 MBR 分区&quot;">​</a></h3><ul><li>MBR（Master Boot Record，主记录引导），诞生于 1982 年，使用 32 bit 来表示扇区数，所以分区最大不能超过 2 T，计算如下所示：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;2 ^ 32 * 512 / 1024 / 1024 / 1024 / 1024 &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 2 TB</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+x+'" alt=""></p><ul><li>MBR 通常位于硬盘的 0 磁道 0 扇区（512 bytes，即 512 B），其中： <ul><li>前 446 bytes 用于引导程序（boot loader），即包含启动计算机所需要的代码，通常用于引导操作系统。</li><li>中间 64 bytes 就是分区表（partition table），每 16 bytes 标识一个分区。</li><li>最后 2 bytes 是固定值 55AA，用于标识该扇区为有效的 MBR，BIOS 会检查此签名以验证 MBR 的有效性。</li></ul></li></ul><blockquote><p>注意⚠️：</p><ul><li>① 因为 MBR 的分区表的限制，所以 MBR 分区的硬盘最多有 4 个主分区，也可以有 3 个主分区 + 1 个扩展分区（N 个逻辑分区）。</li><li>② MBR 分区中的主分区和扩展分区对应的编号是 1 -4 ，逻辑分区到 5 开始。</li></ul></blockquote><ul><li>MBR 硬盘分区结构图：</li></ul><p><img src="'+A+'" alt=""></p><ul><li>其中，MBR 由以下 4 个部分组成：</li></ul><table tabindex="0"><thead><tr><th>地址范围</th><th>功能描述</th><th>备注</th></tr></thead><tbody><tr><td>0000-0088</td><td>Master Boot Record，主引导程序</td><td>它负责从活动分区中装载，并运行系统引导程序。</td></tr><tr><td>0089-01BD</td><td>出错信息数据区</td><td>数据区，用于存储引导过程中可能发生的错误信息。</td></tr><tr><td>01BE-01CD</td><td>分区项1（16字节）</td><td>分区表</td></tr><tr><td>01CE-01DD</td><td>分区项2（16字节）</td><td>分区表</td></tr><tr><td>01DE-01ED</td><td>分区项3（16字节）</td><td>分区表</td></tr><tr><td>01EE-01FD</td><td>分区项4（16字节）</td><td>分区表</td></tr><tr><td>01FE-01FF</td><td>55aa</td><td>结束标志</td></tr></tbody></table><ul><li>示例：备份 MBR 分区表</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/tmp/dpt.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> skip=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">446</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # skip 表示复制 if 的时候跳过</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+D+'" alt=""></p><ul><li>示例：远程发送到其它机器</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/dpt.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root@192.168.10.101:/root</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+_+'" alt=""></p><ul><li>示例：破坏 MBR 分区表</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/zero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/dev/sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seek=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">446</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # seek 表示复制 of 的时候跳过</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+f+'" alt=""></p><ul><li>示例：关机，打开电源进入固件，以光盘启动，进入救援模式</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">shutdown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> now</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+w+'" alt=""></p><ul><li>示例：配置网络</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.10.100/24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ens160</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 如果没有网络，就配置网络</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+q+'" alt=""></p><ul><li>示例：查看 MBR 分区表</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hexdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sda</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+P+'" alt=""></p><ul><li>示例：从远程主机复制对应的文件</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root@192.168.10.101:/root/dpt.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+I+'" alt=""></p><ul><li>示例：恢复 MBR 分区表</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=dpt.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/dev/sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seek=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">446</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+S+'" alt=""></p><ul><li>示例：再次查看 MBR 分区，看是否修复完毕</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hexdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sda</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+M+'" alt=""></p><ul><li>示例：退出光盘</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+L+'" alt=""></p><ul><li>示例：关机，并重新设置硬盘为第一启动项</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">shutdown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> now</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+T+'" alt=""></p><h3 id="_2-3-3-gpt-分区" tabindex="-1">2.3.3 GPT 分区 <a class="header-anchor" href="#_2-3-3-gpt-分区" aria-label="Permalink to &quot;2.3.3 GPT 分区&quot;">​</a></h3><ul><li>在 MBR 硬盘中，分区信息直接存储于主引导记录（MBR）中（主引导记录中还存储着系统的引导程序）。但在 GPT 硬盘中，分区表的位置信息储存在 GPT 头中。但出于<code>兼容性</code>考虑，硬盘的第一个扇区仍然用作 MBR，之后才是 GPT 头。</li><li>跟现代的 MBR 一样，GPT 也使用<code>逻辑区块地址</code>（LBA）取代了早期的 <code>CHS</code> 寻址方式。传统 MB 信息存储于 LBA 0，GPT 头存储于 LBA 1，接下来才是分区表本身。</li><li>GPT 使用 128 UUID 来表示磁盘和分区 ，GPT 分区表会自动备份在头和尾，并使用 CRC 进行校验。</li></ul><p><img src="'+U+'" alt=""></p><ul><li><p>GPT 分区结构分为 4 个区域：</p><ul><li>GPT 头 。</li><li>分区表。</li><li>GPT 分区。</li><li>备份区域。</li></ul></li><li><p>其中，分区表头的格式，如下所示：</p></li></ul><table tabindex="0"><thead><tr><th style="text-align:center;">起始字节</th><th style="text-align:center;">长度</th><th style="text-align:center;">内容</th></tr></thead><tbody><tr><td style="text-align:center;">0</td><td style="text-align:center;">8字节</td><td style="text-align:center;">签名（&quot;EFI PART&quot;, 45 46 49 20 50 41 52 54）</td></tr><tr><td style="text-align:center;">8</td><td style="text-align:center;">4字节</td><td style="text-align:center;">修订（在1.0版中，值是00 00 01 00）</td></tr><tr><td style="text-align:center;">12</td><td style="text-align:center;">4字节</td><td style="text-align:center;">分区表头的大小（单位是字节，通常是92字节，即5C 00 00 00）</td></tr><tr><td style="text-align:center;">16</td><td style="text-align:center;">4字节</td><td style="text-align:center;">分区表头（第0－91字节）的<a href="https://zh.wikipedia.org/wiki/CRC32" target="_blank" rel="noreferrer">CRC32</a>校验，在计算时，把这个字段作为0处理，需要计算出分区序列的CRC32校验后再计算本字段</td></tr><tr><td style="text-align:center;">20</td><td style="text-align:center;">4字节</td><td style="text-align:center;">保留，必须是0</td></tr><tr><td style="text-align:center;">24</td><td style="text-align:center;">8字节</td><td style="text-align:center;">当前LBA（这个分区表头的位置）</td></tr><tr><td style="text-align:center;">32</td><td style="text-align:center;">8字节</td><td style="text-align:center;">备份LBA（另一个分区表头的位置）</td></tr><tr><td style="text-align:center;">40</td><td style="text-align:center;">8字节</td><td style="text-align:center;">第一个可用于分区的LBA（主分区表的最后一个LBA + 1）</td></tr><tr><td style="text-align:center;">48</td><td style="text-align:center;">8字节</td><td style="text-align:center;">最后一个可用于分区的LBA（备份分区表的第一个LBA − 1）</td></tr><tr><td style="text-align:center;">56</td><td style="text-align:center;">16字节</td><td style="text-align:center;">硬盘GUID（在<a href="https://zh.wikipedia.org/wiki/%E9%A1%9EUNIX" target="_blank" rel="noreferrer">类UNIX</a>系统中也叫<a href="https://zh.wikipedia.org/wiki/UUID" target="_blank" rel="noreferrer">UUID</a>）</td></tr><tr><td style="text-align:center;">72</td><td style="text-align:center;">8字节</td><td style="text-align:center;">分区表项的起始LBA（在主分区表中是2）</td></tr><tr><td style="text-align:center;">80</td><td style="text-align:center;">4字节</td><td style="text-align:center;">分区表项的数量</td></tr><tr><td style="text-align:center;">84</td><td style="text-align:center;">4字节</td><td style="text-align:center;">一个分区表项的大小（通常是128）</td></tr><tr><td style="text-align:center;">88</td><td style="text-align:center;">4字节</td><td style="text-align:center;">分区序列的CRC32校验</td></tr><tr><td style="text-align:center;">92</td><td style="text-align:center;">*</td><td style="text-align:center;">保留，剩余的字节必须是0（对于512字节LBA的硬盘即是420个字节）</td></tr></tbody></table><ul><li>主分区表和备份分区表的头分别位于硬盘的第二个扇区（LBA 1）以及硬盘的最后一个扇区。备份分区表头中的信息是关于备份分区表的。</li></ul><h2 id="_2-4-bios-和-uefi" tabindex="-1">2.4 BIOS 和 UEFI <a class="header-anchor" href="#_2-4-bios-和-uefi" aria-label="Permalink to &quot;2.4 BIOS 和 UEFI&quot;">​</a></h2><ul><li>BIOS（Basic Input/Output System）和 UEFI（Unified Extensible Firmware Interface）是计算机系统启动和硬件初始化过程中使用的两种固件接口。它们在功能和设计上有显著差异。</li><li>BIOS 是传统的固件接口，从上世纪 80 年代起广泛使用。它主要负责在操作系统加载前对计算机硬件进行初始化和测试。</li></ul><p><img src="'+R+'" alt=""></p><ul><li><p>BIOS 的主要特点包括：</p><ul><li>① <strong>16 位模式</strong>：BIOS 在启动过程中运行在 16 位实模式下，这限制了其能够直接访问的内存和硬件资源。</li><li>② <strong>启动过程</strong>：BIOS 使用主引导记录（MBR）来存储分区信息和启动代码。MBR 存储在磁盘的第一个扇区，仅支持最多 4 个主分区，每个分区最大为 2 TB。</li><li>③ <strong>界面和设置</strong>：BIOS 提供了一个简单的文本界面，用户可以通过此界面进行硬件配置和系统设置。</li><li>④ <strong>硬件支持</strong>：BIOS 对现代硬件的支持有限，尤其是大容量硬盘和新型外围设备。</li></ul></li><li><p>UEFI 是现代计算机系统使用的固件接口，旨在取代传统的 BIOS，并提供更强大的功能和更灵活的配置选项。</p></li></ul><p><img src="'+G+'" alt=""></p><ul><li><p>UEFI 的主要特点包括：</p><ul><li>① <strong>32 位和 64 位模式</strong>：UEFI 可以在 32 位或 64 位模式下运行，支持更大的内存地址空间和更高效的硬件访问。</li><li>② <strong>启动过程</strong>：UEFI 使用 GUID 分区表（GPT）来管理分区信息，支持的分区数量几乎没有限制，每个分区最大可达 18.8 百万 TB。</li><li>③ <strong>用户界面</strong>：UEFI 提供了更现代的图形用户界面（GUI），使用户可以更直观地进行系统配置和管理。</li><li>④ <strong>安全启动</strong>：UEFI 支持安全启动（Secure Boot），这是一种安全功能，可以防止未经授权的操作系统和恶意软件在启动过程中加载。</li><li>⑤ <strong>扩展性</strong>：UEFI 设计为模块化和可扩展的，允许制造商和开发人员添加新功能和扩展现有功能。</li></ul></li><li><p>传统的 BIOS 运行流程，即 MBR + BIOS ：</p></li></ul><p><img src="'+N+'" alt="image-20240529095833399"></p><ul><li>现代的 UEFI 运行流程，即 UEFI + GPT ：</li></ul><p><img src="'+O+'" alt="image-20240529100006566"></p><blockquote><p>温馨提示ℹ️：</p><ul><li>① BIOS 是一种传统的固件接口，已经服务于计算机系统几十年，但由于其局限性，逐渐被功能更强大、更灵活的 UEFI 所取代。</li><li>② UEFI 提供了对现代硬件和大容量存储的更好支持，并且具有更高的安全性和用户友好性，是当前和未来计算机系统的主流选择，如：Win11 等强制你必须使用 UEFI 。</li></ul></blockquote><h2 id="_2-5-管理分区" tabindex="-1">2.5 管理分区 <a class="header-anchor" href="#_2-5-管理分区" aria-label="Permalink to &quot;2.5 管理分区&quot;">​</a></h2><h3 id="_2-5-1-概述-⭐" tabindex="-1">2.5.1 概述（⭐） <a class="header-anchor" href="#_2-5-1-概述-⭐" aria-label="Permalink to &quot;2.5.1 概述（⭐）&quot;">​</a></h3><ul><li>显示块设备：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>创建分区：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 管理 MBR 分区和 GPT 分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gdisk</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 管理 GPT 分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 高级分区操作，可以是交互或非交互方式</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>注意⚠️：</p><ul><li>① parted 用来管理分区是实时操作，需要谨慎使用。</li><li>② 在实际工作中，通常推荐使用 <code>fdisk</code> ，因为其是手动保存的，更为安全。</li><li>③ 有的时候，当我们使用 <code>fdisk</code> 、<code>parted</code> 或 <code>gdisk</code> 修改分区表后，可能内核尚未更新这些更改，此时就可以使用 <code>partprobe</code> 命令来强制内核重新扫描并更新分区信息，避免重启 Linux 操作系统。</li></ul></blockquote><h3 id="_2-5-2-准备工作" tabindex="-1">2.5.2 准备工作 <a class="header-anchor" href="#_2-5-2-准备工作" aria-label="Permalink to &quot;2.5.2 准备工作&quot;">​</a></h3><ul><li>准备 2 块硬盘，一块是 2 TB 的容量，一块是 4 TB 的容量，即（此处只给出创建 2 TB 容量硬盘的步骤）：</li></ul><p><img src="'+V+'" alt=""></p><p><img src="'+Y+'" alt=""></p><p><img src="'+H+'" alt=""></p><p><img src="'+z+'" alt="image-20240601084535930"></p><p><img src="'+j+'" alt="image-20240601093952858"></p><p><img src="'+Z+'" alt="image-20240601094116782"></p><ul><li>还需要重启下，让内核知道，我们添加了新硬盘，即：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reboot</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+K+`" alt=""></p><h3 id="_2-5-3-使用-parted-命令管理分区" tabindex="-1">2.5.3 使用 parted 命令管理分区 <a class="header-anchor" href="#_2-5-3-使用-parted-命令管理分区" aria-label="Permalink to &quot;2.5.3 使用 parted 命令管理分区&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [OPTION]... [DEVICE [COMMAND [PARAMETERS]...]...]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>COMMAND：</p><ul><li>mklabel LABEL-TYPE：创建分区格式，LABEL-TYPE 是 msdos 或 gpt 。</li><li>print：显示分区表。</li><li>mkpart PART-TYPE [FS-TYPE] START END：创建新分区，指定分区的开始位置和结束位置。</li><li>resizepart NUMBER END：调整分区的大小。</li><li>rm NUMBER：删除分区。</li></ul></li><li><p>常用命令选项：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mklabel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gpt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">msdos</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 创建 gpt 分区格式或 mbr 分区格式</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> print</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 显示分区格式和分区表（分区项）</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkpart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> primary</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> （默认M）#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MBR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 分区格式，创建主分区</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkpart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> extended</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 20GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> （默认M）#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MBR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 分区格式，创建扩展分区</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkpart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logical</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  10GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> （默认M）#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MBR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 分区格式，创建逻辑分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkpart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mypartition</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1GB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10GB</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # GPT 分区格式，创建自定义名称的分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 删除第一个分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 显示所有硬盘分区信息</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>注意⚠️：</p><ul><li>① parted 用来管理分区是实时操作，需要谨慎使用。</li><li>② parted 可以是交互方式，也可以是非交互方式；通常而言，交互方式更为直观。</li></ul></blockquote><ul><li>示例：显示所有块设备</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+X+'" alt=""></p><ul><li>示例：显示所有硬盘分区信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+J+'" alt=""></p><ul><li>示例：使用交互模式，对 /dev/sdc 创建 MBR 分区表</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 通过 help 查看帮助</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mklabel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> msdos</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 创建 MBR 分区格式</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+W+'" alt=""></p><ul><li>示例：使用交互模式，对 /dev/sdc（MBR 分区表），创建第一个主分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkpart</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # enter 就会提示，创建 primary（主分区） 还是 extend（扩展分区）</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ext4</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 默认是 ext2 ，可以输入 ext4 和 xfs ，在交互模式下提示输入文件系统类型，这个类型信息仅用于记录，并不会实际创建文件系统。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  1G</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 开始分区位置</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 10G </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 结束分区位置</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">quit</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 退出交互式模式</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Q+'" alt=""></p><h3 id="_2-5-4-使用-fdisk-命令管理分区-⭐" tabindex="-1">2.5.4 使用 fdisk 命令管理分区（⭐） <a class="header-anchor" href="#_2-5-4-使用-fdisk-命令管理分区-⭐" aria-label="Permalink to &quot;2.5.4 使用 fdisk 命令管理分区（⭐）&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [DEVICE...] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /dev/sda /dev/sdb ，查看分区以及扇区情况</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DEVICE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 管理 MBR 分区或 GPT 分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>子命令列表：</li></ul><table tabindex="0"><thead><tr><th>子命令</th><th>描述</th></tr></thead><tbody><tr><td>m</td><td>帮助</td></tr><tr><td>p（print the partition table）</td><td>显示分区列表信息</td></tr><tr><td>t（change a partition type）</td><td>更改分区类型</td></tr><tr><td>g（create a new empty GPT partition table）</td><td>创建 GPT 分区</td></tr><tr><td>o（create a new empty DOS partition table）</td><td>创建 MBR 分区</td></tr><tr><td>n（add a new partition）</td><td>创建新分区</td></tr><tr><td>d（delete a partition）</td><td>删除分区</td></tr><tr><td>v（verify the partition table）</td><td>校验分区表</td></tr><tr><td>u（change display/entry units）</td><td>转换单位</td></tr><tr><td>w（write table to disk and exit）</td><td>保存并退出</td></tr><tr><td>q （quit without saving changes）</td><td>不保存退出</td></tr></tbody></table><ul><li>示例：查看指定硬盘上的分区和扇区信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+$+'" alt=""></p><ul><li>示例：使用 fdisk 创建 MBR 分区表</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 进入交互模式，默认是 MBR 分区表</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">p</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 显示分区列表信息</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ss+`" alt=""></p><ul><li>示例：使用 fdisk （MBR 分区表）创建分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">n</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">p</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 主分区</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 扩展分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 选择分区数字，即第一个分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+20G</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 划分 20G 的容量给 1 分区；如果没有单位 ，即 +20000 ，就是从 2048 扇区到 20000 扇区划分给 1 分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">w</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 保存并退出</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+is+'" alt=""></p><ul><li>示例：使用 fdisk（MBR 分区表）修改分区类型</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">t</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 第四个分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">05</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # extended 扩展分区，83 Linux 就是 primary 主分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">w</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+as+'" alt=""></p><ul><li>示例：使用 fdisk（MBR 分区表）删除分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">p</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">d</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 删除分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">w</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+es+'" alt=""></p><ul><li>示例：使用 fdisk 创建 GPT 分区表，并进行分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">g</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 默认是 MBR 分区格式，转换为 GPT 分区格式</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 第一个分区</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+200G</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">w</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ls+'" alt=""></p><h2 id="_2-6-文件系统" tabindex="-1">2.6 文件系统 <a class="header-anchor" href="#_2-6-文件系统" aria-label="Permalink to &quot;2.6 文件系统&quot;">​</a></h2><h3 id="_2-6-1-概述" tabindex="-1">2.6.1 概述 <a class="header-anchor" href="#_2-6-1-概述" aria-label="Permalink to &quot;2.6.1 概述&quot;">​</a></h3><ul><li>文件系统是操作系统中用于管理和组织存储设备（如：硬盘、固态硬盘、USB闪存等）上数据的一套方法和数据结构，即在存储设备上管理文件的方法。</li><li>如果没有文件系统，我们必须通过如下的命令，去读取磁盘中的二进制数据：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hexdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sda</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>然后，通过对应的数据转换工具，去操作二进制数据，这既不直观，也不安全！！！</p></li><li><p>操作系统中<code>负责管理</code>和<code>存储文件信息</code>的<code>软件结构</code>称为文件管理系统，简称文件系统。从操作系统的角度上讲，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进行保护和检索。具体地说，文件系统负责为用户建立文件，存入、读出、修改、转储文件，控制文件的 存取，安全控制，日志，压缩，加密等。</p></li><li><p>查看 Linux 支持的文件系统：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib/modules/`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/kernel/fs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ns+'" alt="image-20240604134950638"></p><ul><li>我们也可以通过如下的命令，查看文件系统的帮助手册：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">man</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ts+'" alt=""></p><h3 id="_2-6-2-文件系统的主要作用和常见类型" tabindex="-1">2.6.2 文件系统的主要作用和常见类型 <a class="header-anchor" href="#_2-6-2-文件系统的主要作用和常见类型" aria-label="Permalink to &quot;2.6.2 文件系统的主要作用和常见类型&quot;">​</a></h3><ul><li><p>文件系统的主要作用包括以下几个方面：</p><ul><li>① <strong>文件存储和组织</strong>：文件系统提供一种结构化的方式来存储文件和目录。它使用目录树结构，使得用户能够方便地对文件进行分类和组织。</li><li>② <strong>文件命名</strong>：文件系统允许用户为文件和目录命名，并且通常支持不同类型的文件名格式和命名规则。</li><li>③ <strong>文件访问</strong>：文件系统提供了读、写、修改和删除文件的功能。它管理文件的访问权限，确保文件安全和数据完整性。</li><li>④ <strong>存储管理</strong>：文件系统负责管理存储设备上的空闲空间和已用空间，确保文件可以高效地存储和检索。它使用各种算法来分配和回收存储空间，以减少碎片化。</li><li>⑤ <strong>元数据管理</strong>：文件系统存储和管理有关文件的信息（元数据），如文件大小、创建和修改时间、权限和所有者等。这些元数据有助于操作系统和用户对文件进行管理和控制。</li><li>⑥ <strong>数据恢复和容错</strong>：某些文件系统具有内置的数据恢复和容错机制，可以在硬件故障或意外中断时保护数据，提供一定程度的容错能力和数据恢复功能。</li></ul></li><li><p>常见的文件系统类型包括：</p><ul><li><strong>FAT32</strong> 和 <strong>exFAT</strong>：主要用于闪存设备和兼容性需求广泛的场合。</li><li><strong>NTFS</strong>：Windows 操作系统的默认文件系统，支持高级功能如权限管理、压缩和加密。</li><li><strong>ext4</strong>：Linux 系统常用的文件系统，支持日志记录和大文件。</li><li><strong>ZFS</strong>：一种高性能、高可靠性的文件系统，支持快照和数据压缩。</li><li>……</li></ul></li></ul><blockquote><p>注意⚠️：从 RHEL7 之后，RedHat 就开始推荐使用 ext4 文件系统和 xfs 文件系统。</p></blockquote><h3 id="_2-6-3-回顾虚拟系统" tabindex="-1">2.6.3 回顾虚拟系统 <a class="header-anchor" href="#_2-6-3-回顾虚拟系统" aria-label="Permalink to &quot;2.6.3 回顾虚拟系统&quot;">​</a></h3><ul><li>Linux 中的文件系统繁多，为了简化开发，操作系统就提供了一个统一的接口，即在用户层和文件系统层引入了一个中间层 -- 虚拟文件系统，即：</li></ul><p><img src="'+ps+'" alt="img"></p><blockquote><p>温馨提示ℹ️：</p><ul><li>① 这样带来的好处就是解耦，即操作系统定义了所有文件系统都支持的数据接口和标准接口，而文件系统的实现者去实现这些接口就可以了，屏蔽了底层细节。</li><li>② 应用程序（如：ls、cat 等命令）只需要通过系统调用来调用虚拟文件系统的接口，就可以访问到磁盘上的文件；而不必关注每个文件系统的不同特性。</li></ul></blockquote><ul><li>根据存储位置的不同，可以将文件系统分为三类： <ul><li>磁盘文件系统，直接把数据存储在磁盘中，如：ext2 、ext3、ext4、xfs 等都是这类文件系统。</li><li>内存文件系统，这类文件系统的数据不是存储在硬盘的，而是占用内存空间，我们经常用到的 <code>/proc</code> 和 <code>/sys</code> 文件系统都属于这一类，读写这类文件，实际上是读写内核中相关的数据数据。</li><li>网络文件系统，用来访问其他计算机数据的文件系统，如：NFS、CephFS 。</li></ul></li></ul><h3 id="_2-6-4-创建文件系统-格式化-⭐" tabindex="-1">2.6.4 创建文件系统（格式化，⭐） <a class="header-anchor" href="#_2-6-4-创建文件系统-格式化-⭐" aria-label="Permalink to &quot;2.6.4 创建文件系统（格式化，⭐）&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.FS_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-L </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;LABEL&#39;]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-b </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2048</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4096]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FS_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-L </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;LABEL&#39;]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-b </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2048</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4096]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>常用选项： <ul><li><code>-t FS_TYPE</code>：设置文件类型，有 ext4、xfs、vfat 等，可以通过 <code>cat /proc/filesystems</code> 查看文件系统类型。</li><li><code>-L &#39;LABEL&#39;</code>：设置卷标，通常用来设置未来要挂载的目录。</li><li><code>-b 1024|2048|4096</code>：设置 block 块的大小。</li></ul></li></ul><blockquote><p>注意⚠️：在使用 <code>mkfs</code> 等命名创建文件系统的时候，会生成一个唯一的 UUID ，其作用如下：</p><ul><li>① <strong>文件系统标识</strong>：UUID 是一个唯一的标识符，它可以用来唯一地标识一个文件系统。这在多个文件系统并存的情况下尤其有用。通过 UUID，可以确保每个文件系统都有一个独特的标识，从而避免混淆。</li><li>② <strong>挂载点识别</strong>：在 <code>/etc/fstab</code> 文件中，可以使用文件系统的 UUID 来指定挂载点。这比使用设备名称（如 <code>/dev/sda1</code>）更可靠，因为设备名称可能会因为硬件变化或重新排列而改变，而 UUID 始终不变。</li><li>③ <strong>设备稳定性</strong>：在系统启动时或热插拔设备时，设备名称可能会发生变化，而 UUID 始终与文件系统绑定，确保系统能正确地识别和挂载文件系统。</li><li>④ <strong>文件系统管理</strong>：在某些文件系统管理工具和操作中（如 <code>blkid</code>、<code>lsblk</code> 等），可以通过 UUID 来识别和操作文件系统。这有助于管理员在进行维护和管理时快速准确地定位文件系统。</li></ul></blockquote><ul><li>示例：创建 ext4 文件系统</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+hs+'" alt=""></p><ul><li>示例：创建 xfs 文件系统</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ds+'" alt=""></p><ul><li>示例：创建 xfs 文件系统，并设置 label 信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.xfs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/mnt/sdb3&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+rs+'" alt=""></p><h3 id="_2-6-5-查看和管理分区信息" tabindex="-1">2.6.5 查看和管理分区信息 <a class="header-anchor" href="#_2-6-5-查看和管理分区信息" aria-label="Permalink to &quot;2.6.5 查看和管理分区信息&quot;">​</a></h3><h4 id="_2-6-5-1-查看块设备属性信息-⭐" tabindex="-1">2.6.5.1 查看块设备属性信息（⭐） <a class="header-anchor" href="#_2-6-5-1-查看块设备属性信息-⭐" aria-label="Permalink to &quot;2.6.5.1 查看块设备属性信息（⭐）&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blkid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-U</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--uuid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">uui</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--label</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">labe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [/dev/DEVICE]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>对应的英文：block id，即用于显示或查看块设备（如：硬盘分区）的属性和 UUID。</p></li><li><p>常用的选项：</p><ul><li><code>-U|--uuid &lt;uuid&gt;</code>：根据指定的 UUID 来查找对应的设备。</li><li><code>-L|--label &lt;label&gt;</code>：根据指定的 Label 来查找对应的设备。</li></ul></li><li><p>示例：查看块设备的属性信息</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blkid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ks+'" alt=""></p><ul><li>示例：根据指定的 UUID 来查找对应的设备</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blkid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd50d802-cdb6-48bd-9109-963e29ad3c12</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+cs+'" alt=""></p><ul><li>示例：根据指定的 LABEL 来查找对应的设备</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blkid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+os+'" alt=""></p><h4 id="_2-6-5-2-管理-ext-文件系统的-label" tabindex="-1">2.6.5.2 管理 ext 文件系统的 LABEL <a class="header-anchor" href="#_2-6-5-2-管理-ext-文件系统的-label" aria-label="Permalink to &quot;2.6.5.2 管理 ext 文件系统的 LABEL&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e2label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/DEVICE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [label]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>功能：改变 ext 文件系统的 LABEL 信息。</li></ul><blockquote><p>注意⚠️：如果没有传递 label 信息，默认就是显示指定设备的 ext 文件系统的 LABEL 信息。</p></blockquote><ul><li>示例：改变 ext 文件系统的 LABEL 信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e2label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/mnt/sdb1&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+us+'" alt=""></p><ul><li>示例：查询 ext 文件系统的 LABEL 信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e2label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+gs+'" alt=""></p><h4 id="_2-6-5-3-查找分区" tabindex="-1">2.6.5.3 查找分区 <a class="header-anchor" href="#_2-6-5-3-查找分区" aria-label="Permalink to &quot;2.6.5.3 查找分区&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findfs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [LABEL=value]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findfs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [UUID=value]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>功能：根据 LABEL 或 UUID 查询文件系统对应的设备路径，即分区。</p></li><li><p>示例：根据 LABEL 查询文件系统对应的设备路径，即分区</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LABEL=&quot;/mnt/sdb1&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+bs+'" alt=""></p><ul><li>示例：根据 UUID 查询文件系统对应的设备路径，即分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UUID=&quot;e771fe1e-c4d6-4484-a2e1-a45b2ceef7e0&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ms+'" alt=""></p><h4 id="_2-6-5-4-ext4-文件系统的底层细节" tabindex="-1">2.6.5.4 ext4 文件系统的底层细节 <a class="header-anchor" href="#_2-6-5-4-ext4-文件系统的底层细节" aria-label="Permalink to &quot;2.6.5.4 ext4 文件系统的底层细节&quot;">​</a></h4><ul><li>ext4 文件系统的底层，如下所示：</li></ul><p><img src="'+Fs+'" alt="img"></p><p><img src="'+vs+'" alt="img"></p><ul><li><p>ext4 文件系统的磁盘布局，由以下几个主要部分组成：</p><ul><li><strong>引导扇区（Boot Sector）</strong>：第一个扇区，包含启动加载程序（如果存在）。</li><li><strong>超级块（Superblock）</strong>：超级块是每个文件系统的核心，它保存了文件系统的配置和状态信息，如：块大小、文件系统的总块数、已使用块数等。</li><li><strong>组描述符表（Block Group Descriptor）</strong>：包含了所有块组的描述符，每个描述符存储了块组的起始地址、块位图的地址、inode 位图的地址、inode 表的起始地址等。</li><li><strong>块组（Block Groups）</strong>：文件系统被划分为多个块组，每个块组包含以下几个部分： <ul><li><strong>块位图（Block Bitmap）</strong>：这是一个位图，表示数据块的使用情况。每个位对应一个数据块，0 表示未使用，1 表示已使用。</li><li><strong>inode 位图（Inode Bitmap）</strong>：类似于块位图，表示 inode 的使用情况。</li><li><strong>inode 表（Inode Table）</strong>：inode 是文件系统中的核心数据结构，每个 inode 记录了一个文件或目录的元数据（如权限、所有者、大小、指向数据块的指针等）。</li><li><strong>数据块（Data Blocks）</strong>：数据块是存储实际数据的地方，文件的数据和目录的内容都存储在这里。</li></ul></li></ul></li><li><p>数据读取的流程，如下所示：</p><ul><li>① 查找超级块 -&gt; 获取组描述符表。</li><li>② 从组描述符表找到对应的块组。</li><li>③ 从 inode 位图中查找 inode 表的入口。</li><li>④ 从 inode 表中读取文件的 inode 信息。</li><li>⑤ 通过 inode 中的指针找到文件数据所在的数据块。</li><li>⑥ 从数据块中读取文件数据。</li></ul></li></ul><h4 id="_2-6-5-5-调整-ext-文件系统的可调参数" tabindex="-1">2.6.5.5 调整 ext 文件系统的可调参数 <a class="header-anchor" href="#_2-6-5-5-调整-ext-文件系统的可调参数" aria-label="Permalink to &quot;2.6.5.5 调整 ext 文件系统的可调参数&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tune2fs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-l] [-L LABEL] /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>常用选项：</p><ul><li>-l：显示文件系统的超级块信息（超级块包含文件系统的元数据信息，如：文件系统大小、空闲块数、挂载次数等）。</li><li>-L LABEL：修改标签。</li></ul></li><li><p>示例：查看 ext4 的超级块</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tune2fs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ys+'" alt=""></p><ul><li>示例：查看 ext4 文件系统的标签</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tune2fs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/mnt/sdb1-m&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Cs+'" alt=""></p><h4 id="_2-6-5-6-查看-ext-文件系统的信息" tabindex="-1">2.6.5.6 查看 ext 文件系统的信息 <a class="header-anchor" href="#_2-6-5-6-查看-ext-文件系统的信息" aria-label="Permalink to &quot;2.6.5.6 查看 ext 文件系统的信息&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dumpe2fs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-h] /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>功能：显示超级块和磁盘块分组信息。</li></ul><blockquote><p>注意⚠️：如果加上 -h ，则只显示超级块信息。</p></blockquote><ul><li>示例：显示超级块和磁盘块分组信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dumpe2fs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Bs+'" alt=""></p><ul><li>示例：只显示超级块信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dumpe2fs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Es+'" alt=""></p><h4 id="_2-6-5-7-查看-xfs-的信息" tabindex="-1">2.6.5.7 查看 xfs 的信息 <a class="header-anchor" href="#_2-6-5-7-查看-xfs-的信息" aria-label="Permalink to &quot;2.6.5.7 查看 xfs 的信息&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xfs_info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>示例：显示 xfs 文件系统的信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xfs_info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+xs+'" alt=""></p><h3 id="_2-6-6-文件系统的检测和修复" tabindex="-1">2.6.6 文件系统的检测和修复 <a class="header-anchor" href="#_2-6-6-文件系统的检测和修复" aria-label="Permalink to &quot;2.6.6 文件系统的检测和修复&quot;">​</a></h3><h4 id="_2-6-6-1-概述" tabindex="-1">2.6.6.1 概述 <a class="header-anchor" href="#_2-6-6-1-概述" aria-label="Permalink to &quot;2.6.6.1 概述&quot;">​</a></h4><ul><li>文件系统出现故障通常发生于死机或非正常关机之后，挂载的文件文件标记为 &quot;no clean&quot; 。</li></ul><blockquote><p>注意⚠️：</p><ul><li>① 不要在挂载状态下，进行文件系统的修复，请先使用 <code>umount</code> 命令卸载文件系统！！！</li><li>② 实际工作中，通常会使用 RAID 或 LVM 技术，来实现数据的备份和恢复，防止出现单块硬盘上的分区或文件系统损坏而造成数据丢失！！！</li></ul></blockquote><h4 id="_2-6-6-2-文件系统检测和修复" tabindex="-1">2.6.6.2 文件系统检测和修复 <a class="header-anchor" href="#_2-6-6-2-文件系统检测和修复" aria-label="Permalink to &quot;2.6.6.2 文件系统检测和修复&quot;">​</a></h4><ul><li>fsck 命令：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fsck.FS_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-p][-y][-f] /dev/DEVICE </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># FS_TYPE 需要和分区上的文件系统类型相同</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fsck</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FS_TYPE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-p][-y][-f] /dev/DEVICE </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># FS_TYPE 需要和分区上的文件系统类型相同</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>常用选项：</p><ul><li>-p：自动进行安全的修复文件系统问题。</li><li>-y：自动应答为 yes。</li><li>-f：强制修复。</li></ul></li><li><p>e2fsck 命令（ext 系列文件专用的检测修复工具）：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e2fsck</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-p][-y][-f][-n] /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>常用选项：</p><ul><li><p>-n：只检查。</p></li><li><p>-p：自动进行安全的修复文件系统问题。</p></li><li><p>-y：自动应答为 yes。</p></li><li><p>-f：强制修复。</p></li></ul></li><li><p>xfs_repair 命令（xfs文件系统专用检测修复工具）：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xfs_repair</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-d][-n][-f] /dev/DEVICE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>常用选项：</p><ul><li><p>-f：修复文件而不是块设备。</p></li><li><p>-n：只检查。</p></li><li><p>-d：允许修复只读的挂载设备，在单用户下修复 <code>/</code> 时使用，然后立即 reboot 。</p></li></ul></li><li><p>示例：将 ext4 文件系统挂载到某个目录，并复制文件到其中</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+As+'" alt=""></p><ul><li>示例：破坏 ext4 文件系统，并查看文件是否损坏</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/zero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/dev/sdb1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=1M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ds+'" alt=""></p><ul><li>示例：查询 ext4 文件系统的超级块信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tune2fs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+_s+'" alt=""></p><ul><li>示例：卸载文件系统</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">umount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+fs+'" alt=""></p><ul><li>示例：检测文件系统</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e2fsck</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ws+'" alt=""></p><ul><li>示例：修复文件系统</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">e2fsck</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+qs+'" alt=""></p><ul><li>示例：查询 ext4 文件系统的超级块信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tune2fs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ps+'" alt=""></p><ul><li>示例：挂载，并查看文件是否恢复成功</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Is+`" alt=""></p><h2 id="_2-7-挂载-⭐" tabindex="-1">2.7 挂载（⭐） <a class="header-anchor" href="#_2-7-挂载-⭐" aria-label="Permalink to &quot;2.7 挂载（⭐）&quot;">​</a></h2><h3 id="_2-7-1-概述" tabindex="-1">2.7.1 概述 <a class="header-anchor" href="#_2-7-1-概述" aria-label="Permalink to &quot;2.7.1 概述&quot;">​</a></h3><ul><li>挂载：就是将额外的文件系统和根文件系统某个现存的目录建立关联关系，进而使得此目录可以作为其他文件访问的入口的行为。</li><li>卸载：解除这种关联关系的行文。</li></ul><blockquote><p>注意⚠️：</p><ul><li>① 将设备（文件系统）关联到某个目录，该目录被称为挂载点（mountpoint），挂载点下原有文件在挂载完成后会被临时隐藏，因此，挂载点目录一般为空。</li><li>② 进程正在使用中的设备无法被卸载。</li></ul></blockquote><h3 id="_2-7-2-挂载" tabindex="-1">2.7.2 挂载 <a class="header-anchor" href="#_2-7-2-挂载" aria-label="Permalink to &quot;2.7.2 挂载&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-rvwa] [-o options] device mountpoint</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>其中，device 指的是要挂载的设备，有如下的四种形式：</li></ul><table tabindex="0"><thead><tr><th>挂载设备的形式</th><th>样例</th></tr></thead><tbody><tr><td>设备文件</td><td>/dev/sdb1</td></tr><tr><td>卷标（-L &#39;LABEL&#39;）</td><td>-L &#39;/mnt/sdb1&#39;</td></tr><tr><td>UUID（-U &#39;UUID&#39;）</td><td>-U &#39;e771fe1e-c4d6-4484-a2e1-a45b2ceef7e0&#39;</td></tr><tr><td>伪文件系统名称</td><td>proc、sysfs、devtmpfs、tmpfs</td></tr></tbody></table><ul><li>其中，mountpoint 是挂载点，必须事前存在，建议使用空目录。</li><li>常用选项：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-r,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --read-only</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 只读挂载，类似于 -o ro</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-w,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rw,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --read-write</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 读写挂载，默认</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-a,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 将 /etc/fstab 文件中所列出的挂载信息加载进内存</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;LABEL&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 以卷标指定挂载设备</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;UUID&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 以 UUID 指定要挂载的设备</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-B,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --bind</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 绑定目录到另一个目录上</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> options：#</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (挂载文件系统的选项)，多个选项使用逗号分隔</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   async</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 异步模式,内存更改时,写入缓存区buffer,过一段时间再写到磁盘中，效率高，但不安全</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   sync</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 同步模式,内存更改时，同时写磁盘，安全，但效率低下</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   atime/noatime</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启用或关闭（目录和文件的访问时间）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   diratime/nodiratime</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启用或关闭（目录的访问时间）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   auto/noauto</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 是否支持开机自动挂载，是否支持 -a 选项</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   exec/noexec</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 是否允许文件系统上执行二进制文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   dev/nodev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 是否支持在此文件系统上使用设备文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   suid/nosuid</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 是否支持 suid 和 sgid 权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   remount</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 重新挂载</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   ro/rw</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 只读、读写</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   user/nouser</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 是否允许普通用户挂载此设备，/etc/fstab使用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   acl/noacl</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启用此文件系统上的 acl 功能</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   loop</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 使用 loop 设备</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   _netdev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 当网络可用时才对网络资源进行挂载，如：NFS 文件系统</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   defaults</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 相当于 rw, suid, dev, exec, auto, nouser, async</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>注意⚠️：挂载规则</p><ul><li>① 一个挂载点同一时间只能挂载一个设备</li><li>② 一个挂载点同一时间挂载了多个设备，只能看到最后一个设备的数据，其它设备上的数据将被隐藏。</li><li>③ 一个设备可以同时挂载到多个挂载点。</li><li>④ 通常挂载点一般是已存在空的目录。</li></ul></blockquote><ul><li>示例：挂载（临时挂载，一旦重启，挂载关系将会失效，也称为手动挂载）</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1-m</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1-m</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+Ss+'" alt=""></p><h3 id="_2-7-3-卸载" tabindex="-1">2.7.3 卸载 <a class="header-anchor" href="#_2-7-3-卸载" aria-label="Permalink to &quot;2.7.3 卸载&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">umount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/DEVICE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mountpoint</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>示例：使用设备名卸载</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">umount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ms+'" alt=""></p><ul><li>示例：使用挂载点卸载</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">umount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1-m</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ls+'" alt=""></p><h3 id="_2-7-4-查看挂载信息" tabindex="-1">2.7.4 查看挂载信息 <a class="header-anchor" href="#_2-7-4-查看挂载信息" aria-label="Permalink to &quot;2.7.4 查看挂载信息&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 通过查看 /etc/mtab 文件显示当前已挂载的所有设备</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>注意⚠️：</p><ul><li>① <code>/etc/mtab</code> 是一个在 Linux 系统中用于记录当前挂载文件系统的文件。它包含了系统当前挂载的所有文件系统的信息，包括挂载点、文件系统类型和挂载选项。</li><li>② <code>/etc/mtab</code> 通常由系统自动生成和更新，不需要手动编辑。系统会在每次挂载或卸载文件系统时更新该文件。</li></ul></blockquote><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /proc/mounts</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 查看内核追踪到的已挂载的所有设备</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>注意⚠️：现代 Linux 系统中，<code>/proc/mounts</code> 文件提供了与 <code>/etc/mtab</code> 类似的信息，并且总是最新的，因为它直接从内核获取数据。由于 <code>/etc/mtab</code> 可能会因为某些原因不准确，因此有时建议查看 <code>/proc/mounts</code> 以获取当前系统的挂载信息。</p></blockquote><ul><li>示例：查看挂载信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ts+'" alt=""></p><ul><li>示例：查看挂载信息</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /proc/mounts</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Us+'" alt=""></p><h3 id="_2-7-5-查看挂载点情况" tabindex="-1">2.7.5 查看挂载点情况 <a class="header-anchor" href="#_2-7-5-查看挂载点情况" aria-label="Permalink to &quot;2.7.5 查看挂载点情况&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findmnt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/DEVICE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mountpoint</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>示例：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findmnt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Rs+'" alt=""></p><h3 id="_2-7-6-查看正在访问指定文件系统的进程并终止" tabindex="-1">2.7.6 查看正在访问指定文件系统的进程并终止 <a class="header-anchor" href="#_2-7-6-查看正在访问指定文件系统的进程并终止" aria-label="Permalink to &quot;2.7.6 查看正在访问指定文件系统的进程并终止&quot;">​</a></h3><ul><li>查看正在访问指定文件系统的进程：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsof</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mount_point</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">文件</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fuser</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mount_point</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">文件</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>终止所有在正访问指定的文件系统的进程：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fuser</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -km</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mount_point</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # -k,--kill 杀死，-m,--mount 挂载</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>注意⚠️：卸载之前，必须保证没有任何进程访问该文件系统中的文件。</p></blockquote><ul><li>示例：使用另外一种用户进入挂载点，并访问文件系统中的数据</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1-m/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1-m/fstab</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Gs+'" alt=""></p><ul><li>示例：查看正在访问指定文件系统的进程</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fuser</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ns+'" alt=""></p><ul><li>示例：终止所有在正访问指定的文件系统的进程</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fuser</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -km</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/sdb1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Os+`" alt=""></p><h3 id="_2-7-7-永久挂载" tabindex="-1">2.7.7 永久挂载 <a class="header-anchor" href="#_2-7-7-永久挂载" aria-label="Permalink to &quot;2.7.7 永久挂载&quot;">​</a></h3><ul><li>之前，通过 mount 都是手动挂载的方式，一旦系统重启，挂载关联关系将会失败；如果需要永久挂载，就需要将挂载关联关系保存到磁盘上的配置文件中，即 <code>/etc/fstab</code> 文件。</li></ul><blockquote><p>注意⚠️：可以通过 <code>man 5 fstab</code> 命令查看 fstab 配置文件的格式。</p></blockquote><ul><li>示例：永久挂载</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:r!blkid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dd222109-67e4-4b93-a74b-6c227055f53c</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /mnt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                   ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    defaults</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 自动挂载所有支持自动挂载的设备(定义在了 /etc/fstab 文件中，且挂载选项中有 auto 功能)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+Vs+'" alt=""></p><h3 id="_2-7-8-挂载文件-将文件作为设备使用" tabindex="-1">2.7.8 挂载文件（将文件作为设备使用） <a class="header-anchor" href="#_2-7-8-挂载文件-将文件作为设备使用" aria-label="Permalink to &quot;2.7.8 挂载文件（将文件作为设备使用）&quot;">​</a></h3><ul><li><p>mount 也支持将一个文件作为 loop 设备，挂载到指定的目录中，作为文件系统来使用；其步骤如下：</p><ul><li>① 创建一个空文件。</li><li>② 在这个文件上创建文件系统。</li><li>③ 创建挂载点，即空目录。</li><li>④ 将文件系统镜像挂载到挂载点。</li></ul></li><li><p>示例：创建一个空文件</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/zero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=1M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ys+'" alt=""></p><ul><li>示例：将文件作为一个设备文件，在上面创建文件系统</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.ext4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data.img</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Hs+'" alt=""></p><ul><li>示例：创建挂载点，即空目录</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/iso</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+zs+'" alt=""></p><ul><li>示例：将文件系统镜像挂载到挂载点，并复制文件进去</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/iso</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # losetup -a 查询所有的回环设备</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt/iso</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+js+'" alt=""></p><ul><li>示例：将该文件远程发送到其它系统中，并挂载到指定目录，再查看</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root@192.168.10.101:/root</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ll</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Zs+'" alt=""></p><h2 id="_2-8-交换分区" tabindex="-1">2.8 交换分区 <a class="header-anchor" href="#_2-8-交换分区" aria-label="Permalink to &quot;2.8 交换分区&quot;">​</a></h2><h3 id="_2-8-1-概述" tabindex="-1">2.8.1 概述 <a class="header-anchor" href="#_2-8-1-概述" aria-label="Permalink to &quot;2.8.1 概述&quot;">​</a></h3><ul><li>在 Linux 操作系统中，swap 分区（交换分区）是一种虚拟内存技术，用于扩展物理内存的容量。它通过在磁盘上分配一块空间来存储临时不常用的数据，当物理内存不足时，系统会将部分内存数据移至 swap 分区，以释放更多的物理内存用于当前进程。</li><li>swap 分区的作用如下： <ul><li>① <strong>扩展内存</strong>：在物理内存（RAM）不足的情况下，swap 分区可以作为扩展的内存空间使用。</li><li>② <strong>内存管理</strong>：当系统需要更多的内存而物理内存已经用完时，swap 分区可以防止系统崩溃或强制终止进程。</li><li>③ <strong>性能管理</strong>：通过将不常用的内存数据移至 swap 分区，系统可以更有效地管理内存资源。</li></ul></li><li>但是，配置过多 swap 空间会造成存储设备处于分配和闲置状态，造成浪费，过多 swap 空间还会掩盖内存泄露。</li></ul><h3 id="_2-8-2-swap-分区建议" tabindex="-1">2.8.2 swap 分区建议 <a class="header-anchor" href="#_2-8-2-swap-分区建议" aria-label="Permalink to &quot;2.8.2 swap 分区建议&quot;">​</a></h3><ul><li>swap 分区的大小通常建议根据系统的物理内存大小和用途来设置。传统建议是： <ul><li>对于 2GB 或更小的 RAM，swap 大小应为物理内存的两倍。</li><li>对于 2GB 到 8GB 的 RAM，swap 大小应与物理内存相同。</li><li>对于 8GB 以上的 RAM，swap 大小应为 4GB 到 8GB。</li></ul></li></ul><blockquote><p>注意⚠️：</p><ul><li><p>① 不过，具体的 swap 大小需要根据实际使用情况和需求来决定。</p></li><li><p>② 通过正确配置和管理 swap 分区，Linux 系统可以更高效地利用内存资源，提升系统的稳定性和性能。</p></li><li><p>③ 在将来使用容器化技术，如：Docker 等，会需要将 swap 分区关闭，是因为性能问题、内存限制和隔离、简化资源管理等原因。</p></li></ul></blockquote><h3 id="_2-8-3-创建交换分区" tabindex="-1">2.8.3 创建交换分区 <a class="header-anchor" href="#_2-8-3-创建交换分区" aria-label="Permalink to &quot;2.8.3 创建交换分区&quot;">​</a></h3><ul><li><p>步骤：</p><ul><li>① 创建分区：使用 fdisk 、gdisk 或 parted 等工具创建一个新的分区，并需要将分区类型设置为 19 或 8200 （Linux 的 swap 分区）。</li><li>② 格式化分区：使用 mkswap 工具格式化所创建的新的分区。</li><li>③ 启用分区：使用 swapon 命令启动新的分区。</li><li>④ 永久挂载：通过编辑 /etc/fstab 文件，在其中配置 swap ，以实现即使系统重启也会自动挂载 swap 分区。</li><li>⑤ 查看分区是否创建成功：使用 <code>free -h</code> 或 <code>swapon --show</code> 命令验证。</li></ul></li><li><p>示例：创建分区</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fdisk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ks+'" alt=""></p><ul><li>示例：格式化分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkswap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Xs+'" alt=""></p><ul><li>示例：启用分区（手动启用，重启会失效）</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swapon</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Js+'" alt=""></p><ul><li>示例：查看是否启用成功</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">free</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swapon</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --show</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+Ws+`" alt=""></p><ul><li>示例：永久挂载</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:r!blkid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1a6e9b62-112f-4531-aa6e-c0b1d2d48db5</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> none</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    defaults</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 增加</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swapon</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+Qs+'" alt=""></p><h3 id="_2-8-4-关闭-swap-分区-⭐" tabindex="-1">2.8.4 关闭 swap 分区（⭐） <a class="header-anchor" href="#_2-8-4-关闭-swap-分区-⭐" aria-label="Permalink to &quot;2.8.4 关闭 swap 分区（⭐）&quot;">​</a></h3><ul><li>手动关闭（临时关闭，重启无效）：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swapoff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 关闭当前会话的 swap ，重启之后无效</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>永久关闭：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ri</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/.*swap.*/#&amp;/&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 需要重启</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>示例：关闭 swap 分区</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">swapoff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ri</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/.*swap.*/#&amp;/&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+$s+'" alt=""></p><h2 id="_2-9-移动介质" tabindex="-1">2.9 移动介质 <a class="header-anchor" href="#_2-9-移动介质" aria-label="Permalink to &quot;2.9 移动介质&quot;">​</a></h2><h3 id="_2-9-1-概述" tabindex="-1">2.9.1 概述 <a class="header-anchor" href="#_2-9-1-概述" aria-label="Permalink to &quot;2.9.1 概述&quot;">​</a></h3><ul><li>挂载意味着将外来的文件系统看起来如同主目录树的一部分，所有的移动介质同样也需要挂载，挂载点通常在 <code>/media</code> 或 <code>/mnt</code> 下。</li><li>在访问移动介质之前，需要将移动介质挂载到主目录树。</li><li>在摘除移动介质之前，需要将移动介质从主目录树上卸载。</li></ul><h3 id="_2-9-2-光盘" tabindex="-1">2.9.2 光盘 <a class="header-anchor" href="#_2-9-2-光盘" aria-label="Permalink to &quot;2.9.2 光盘&quot;">​</a></h3><ul><li>在图形化界面，会自动挂载到 <code>/run/media</code> 目录下。</li><li>但是，如果是命令行界面，还需要手动挂载，即：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sr0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # /dev/cdrom 是 /dev/sr0 的软链接，某种意义上两者是等价的</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>创建 iso 文件：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sr0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/almaLinux9.iso</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 需要先挂载，再复制</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkisofs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/etc.iso</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # dnf -y install xorriso</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-9-3-usb" tabindex="-1">2.9.3 USB <a class="header-anchor" href="#_2-9-3-usb" aria-label="Permalink to &quot;2.9.3 USB&quot;">​</a></h3><ul><li>在图形化界面，会自动挂载到 <code>/run/media</code> 目录下。</li><li>但是，在命令行界面，还需要手动挂载，即：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mnt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>可以通过查看系统日志，以确认 USB 设备是否识别：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dmesg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tail</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>查看 USB 设备，即：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsusb</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # dnf -y install usbutils</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="_2-10-磁盘常用工具-⭐" tabindex="-1">2.10 磁盘常用工具（⭐） <a class="header-anchor" href="#_2-10-磁盘常用工具-⭐" aria-label="Permalink to &quot;2.10 磁盘常用工具（⭐）&quot;">​</a></h2><h3 id="_2-10-1-df" tabindex="-1">2.10.1 df <a class="header-anchor" href="#_2-10-1-df" aria-label="Permalink to &quot;2.10.1 df&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">df</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-h][-i][-T]... [/dev/DEVICE]...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>对应的英文：disk free。</p></li><li><p>功能：查看文件系统（分区）的磁盘空间使用情况。</p></li><li><p>常用选项：</p><ul><li><code>-h</code>，<code>--human-readable</code>：以人类可读的方式显示，如：20 GB 等，默认是以 KB 为单位。</li><li><code>-i</code>, <code>--inodes</code>：显示 inode 的信息，而不显示 block，默认不显示。</li><li><code>-T</code>，<code>--print-type</code>：打印文件系统。</li></ul></li><li><p>示例：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">df</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+si+'" alt=""></p><ul><li>示例：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">df</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ii+'" alt=""></p><ul><li>示例：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">df</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Th</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ai+'" alt=""></p><h3 id="_2-10-2-du" tabindex="-1">2.10.2 du <a class="header-anchor" href="#_2-10-2-du" aria-label="Permalink to &quot;2.10.2 du&quot;">​</a></h3><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">du</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-h][-s][-a][-d]... [FILE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DIRECTORY]...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><p>对应的英文：disk usage。</p></li><li><p>功能：显示文件（集合）或目录在磁盘上的使用空间。</p></li><li><p>常用选项：</p><ul><li><code>-h</code>，<code>--human-readable</code>：以人类可读的方式显示，如：20 GB 等，默认是以 KB 为单位。</li><li><code>-s</code>，<code>--summarize</code>：显示总数。</li><li><code>-d</code>，<code>--max-depth=N</code>：指定最大目录层级。</li><li><code>-a</code>, <code>--all</code>：显示所有的文件，而不仅仅包括目录。</li></ul></li><li><p>示例：</p></li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">du</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ei+'" alt=""></p><ul><li>示例：查询指定目录中，文件体积最大的前 5 个</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> du</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+li+`" alt=""></p><h3 id="_2-10-3-dd" tabindex="-1">2.10.3 dd <a class="header-anchor" href="#_2-10-3-dd" aria-label="Permalink to &quot;2.10.3 dd&quot;">​</a></h3><h4 id="_2-10-3-1-概述" tabindex="-1">2.10.3.1 概述 <a class="header-anchor" href="#_2-10-3-1-概述" aria-label="Permalink to &quot;2.10.3.1 概述&quot;">​</a></h4><ul><li>格式：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/PATH/FROM/SRC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/PATH/TO/DEST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count=#</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>对应的英文：convert and copy a file。</li><li>功能：转换和复制文件，常用于备份整个硬盘或创建磁盘映像。</li><li>常用的选项：</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">file</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # inputfile，从所命名文件读取而不是从标准输入</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">of</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">file</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # outputfile，写到所命名的文件而不是到标准输出</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ibs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BYTES</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 一次性读入指定的块，默认是 512B 的块大小，可以使用 b、K、M、G 、T、P、E、Z、Y 等单位</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BYTES</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 一次性写入指定的块，默认是 512B 的块大小，可以使用 b、K、M、G 、T、P、E、Z、Y 等单位</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BYTES</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 一次性读入和写入指定的块，默认是 512B 的块大小，会覆盖 ibs 和 obs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cbs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BYTES</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 一次性转换指定的块，默认是 512B 的块大小，可以使用 b、K、M、G 、T、P、E、Z、Y 等单位</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">skip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">blocks</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 当读取文件的时候，从开头忽略 blocks 个 ibs 大小的块</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">seek</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">blocks</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 当写入文件的时候，从开头忽略 blocks 个 obs 大小的块</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 复制 n 个 bs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">conversion[,conversion...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 用指定的参数转换文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	ascii</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 转换 EBCDIC 为 ASCII</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ebcdic</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 转换 ASCII 为 EBCDIC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    lcase</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 把大写字符转换为小写字符</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ucase</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 把小写字符转换为大写字符</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    nocreat</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 不创建输出文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    noerror</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 出错时不停止</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    notrunc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 不截短输出文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sync</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 把每个输入块填充到ibs个字节，不足部分用空(NUL)字符补齐</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    fdatasync</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 写完成前，物理写入输出文</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_2-10-3-3-应用示例" tabindex="-1">2.10.3.3 应用示例 <a class="header-anchor" href="#_2-10-3-3-应用示例" aria-label="Permalink to &quot;2.10.3.3 应用示例&quot;">​</a></h4><ul><li>示例：将本地的 <code>/dev/sda</code> 整盘备份到 <code>/dev/sdb</code> 中（危险，谨慎使用）</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=40M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status=progress</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+ni+'" alt=""></p><ul><li>示例：将本地的 <code>/dev/sda</code> 整盘备份到 <code>/dev/sdb</code> 中（危险，谨慎使用，借助镜像文件）</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/mnt/backup.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=40M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status=progress</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/mnt/backup.img</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=/dev/sdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=40M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status=progress</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+ti+'" alt=""></p>',577),di=[hi];function ri(ki,ci,oi,ui,gi,bi){return a(),i("div",null,di)}const vi=s(pi,[["render",ri]]);export{Fi as __pageData,vi as default};
